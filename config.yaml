# =============================================================================
# TRADING FRAMEWORK - BACKTEST CONFIGURATION
# =============================================================================

# === BACKTEST SETTINGS ===
backtest:
  # Test period (optional - uses all data if omitted)
  period:
    start: "2025-12-01"
    end: "2026-01-22"
  
  # Initial capital
  capital:
    initial: 10000
  
  # Trading costs
  costs:
    commission: 0.001      # 0.1% per trade (simple: one value for now)
    # slippage: 0.0        # Future: add slippage
  
  # Execution settings
  execution:
    lookback_window: 100   # Bars to keep in memory for indicators


# === DATA SOURCE ===
data:
  symbols: ["XPLUSDT"]                           # Symbols to backtest
  timeframe: "1m"                                # Raw data timeframe (always 1m)
  source_dir: "data/raw"                         # Directory with parquet files
  source_file: "XPLUSDT-1m-2025-2026-01-22"     # Filename without .parquet extension


# === STRATEGY CONFIGURATION ===
strategy:
  timeframe: "1h"          # ✅ Strategy timeframe (controls everything)
  
  # Entry strategy
  entry:
    name: "price_above_sma"
    params:
      sma_column: "sma_200"  # ✅ Reference to indicator column
      lookback: 1
  
  # Exit strategy
  exit:
    name: "hold_bars"
    params:
      bars: 100
  
  # Risk management
  risk:
    name: "fixed_percent"
    params:
      risk_per_trade: 0.02   # Risk 2% of equity per trade
      max_drawdown: 0.15     # Optional: stop trading if DD > 15%


# === INDICATORS ===
# All calculated at strategy.timeframe
indicators:
  - name: "sma"
    params: {period: 200}
    column: "sma_200"        # ✅ Column name (strategy references this)
  
  # - name: "sma"
  #   params: {period: 50}
  #   column: "sma_50"
  
  # - name: "atr"
  #   params: {period: 14}
  #   column: "atr_14"


# === OUTPUT SETTINGS ===
output:
  # Journal (trades, equity, etc.)
  journal:
    save_dir: "data/journals/"
    # filename_template: "{symbol}_{strategy_tf}_{entry}_{timestamp}"
  
  # Plots configuration
  plots:
    enabled: true
    save_dir: "data/plots/"


# === PLOTTING CONFIGURATION ===
# Kept at root level for simplicity
# For simplicity at the moment this section must match with the above indicators
plotting:
  # Indicators to plot (overlaid on price chart)
  indicators_to_plot:
    - column: "sma_200"
      label: "SMA 200"
      color: "#ff0000"
      linewidth: 2
      alpha: 1.0
    
    # - column: "sma_50"
    #   label: "SMA 50"
    #   color: "#0000ff"
    #   linewidth: 1.5
    #   alpha: 0.8
  
  # Layout configuration
  layout:
    price_height_ratio: 3
    panel_height_ratio: 1
    position_height_ratio: 1
  
  # Style settings
  style:
    background_color: "#f5f5f5"
    grid_alpha: 0.2