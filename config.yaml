# =============================================================================
# TRADING FRAMEWORK - BACKTEST CONFIGURATION
# =============================================================================

# === DATA SOURCE ===
data:
  symbols: ["XPLUSDT"]
  timeframe: "1m"
  source_dir: "data/raw"
  source_file: "XPLUSDT-1m"

# === BACKTEST SETTINGS ===
backtest:
  period:
    start: "2026-01-15"
    end: ""
  
  capital:
    initial: 10000
  
  costs:
    commission: 0.001
  
  execution:
    lookback_window: 100

# === STRATEGY CONFIGURATION ===
strategy:
  timeframe: "5m"
  
  # Trading configuration
  trading:
    allow_long: true
    allow_short: true
    allow_reversal: false
  
  # Risk management
  risk:
    name: "fixed_percent"
    params:
      risk_per_trade: 0.03
      max_drawdown: 0.15
  
  # ========================================
  # ENTRY STRATEGY
  # ========================================
  entry:
    name: "ema_cross_sma_cvd"
    
    params:
      long_threshold: 50.0
      short_threshold: 50.0
    
    indicators:
      - name: "ema"
        period: 54
        visual:
          plot: true
          overlay: true
          color: "#0052CC"  # Orange
          linewidth: 2
          alpha: 0.8
          label: "EMA 54"
      
      - name: "sma"
        period: 200
        visual:
          plot: true
          overlay: true
          color: "#FF6B00"  # Blue
          linewidth: 2
          alpha: 0.8
          label: "SMA 200"
      
      - name: "cvdratio"
        cumulative_period_minutes: 1
        signal_period_minutes: 15
        use_quote: false
        visual:
          plot: true
          overlay: false
          color: "#8E44AD"
          linewidth: 1.5
          alpha: 0.7
          label: "CVD Signal %"
          panel:
            ylim: [0, 100]
            zero_line: false
            hlines:
              - value: 50
                color: "#7F8C8D"
                linestyle: "-"
                alpha: 0.3
                label: "Neutral"
  
  # ========================================
  # EXIT STRATEGY
  # ========================================
  exit:
    name: "atr_based_exit"
    
    params:
      tp_multiplier: 7
      sl_multiplier: 6
      dynamic: true
    
    indicators:
      - name: "atr"
        period: 21
        method: "wilder"
    
    # Visual configuration for SL/TP levels
    visual:
      sl_tp:
        enabled: true
        # dynamic: true -> It's the strategy that decide how to handle SL/TP
        style:
          tp_color: "#27AE60"
          sl_color: "#E74C3C"
          zone_color: "#F1C40F"
          zone_alpha: 0.1
          line_width: 1.5
          line_style: "--"
        annotations:
          show_entry_exit: true
          show_pnl: true
          font_size: 8
          box_style: "round,pad=0.3"

# ========================================
# ANALYSIS INDICATORS (not used by strategy)
# ========================================
analysis_indicators:
  # - name: "rsi"
  #   period: 14
  #   visual:
  #     plot: true
  #     overlay: false
  #     color: "#E74C3C"
  #     linewidth: 1.5
  #     label: "RSI 14"
  #     panel:
  #       ylim: [0, 100]
  #       zero_line: false
  #       hlines:
  #         - value: 30
  #           color: "#95A5A6"
  #           linestyle: "--"
  #           alpha: 0.5
  #           label: "Oversold"
  #         - value: 70
  #           color: "#95A5A6"
  #           linestyle: "--"
  #           alpha: 0.5
  #           label: "Overbought"
  
  # Uncomment to add MACD
  # - name: "macd"
  #   fast_period: 12
  #   slow_period: 26
  #   signal_period: 9
  #   visual:
  #     plot: true
  #     overlay: false
  #     color: "#3498DB"
  #     linewidth: 1.5
  #     label: "MACD"
  #     panel:
  #       zero_line: true
  #       hlines:
  #         - value: 0
  #           color: "#7F8C8D"
  #           linestyle: "-"
  #           alpha: 0.3

# ========================================
# PLOT LAYOUT & STYLE
# ========================================
plot_config:
  layout:
    price_height_ratio: 3
    panel_height_ratio: 1
    position_height_ratio: 1
    figure_size: [16, 10]
  
  style:
    background_color: "#f5f5f5"
    grid_color: "#E0E0E0"
    grid_alpha: 0.2
    candlestick:
      up_color: "#26A69A"
      down_color: "#EF5350"
      wick_color: "#000000"
      alpha: 0.8

# === OUTPUT SETTINGS ===
output:
  journal:
    save_dir: "data/journals/"
  
  plots:
    enabled: true
    save_dir: "data/plots/"
    formats: ["png", "html"]  # Supporta entrambi